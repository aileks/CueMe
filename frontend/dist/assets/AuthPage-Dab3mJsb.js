import{r as a,u as j,j as e,N as w,T as v}from"./index-6m0slvRf.js";function y({onSwitchToRegister:c}){const[l,m]=a.useState(""),[d,b]=a.useState(""),[r,u]=a.useState({}),[x,p]=a.useState(!1),{login:s}=j(),o=async n=>{n.preventDefault(),p(!0),u({});try{const i=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:l,password:d})}),f=await i.json();if(!i.ok){u(f);return}s(f)}catch{u({message:["An unexpected error occurred. Please try again."]})}finally{p(!1)}};return e.jsx("div",{className:"mx-auto w-full max-w-md",children:e.jsxs("div",{className:"my-8 neu-card",children:[e.jsx("h2",{className:"mb-6 text-3xl font-bold",children:"Log In"}),r.message&&e.jsx("div",{className:"mb-4 bg-destructive p-3 text-destructive-foreground",children:r.message.map((n,i)=>e.jsx("p",{children:n},i))}),e.jsxs("form",{onSubmit:o,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"mb-2 block font-medium",children:"Email"}),e.jsx("input",{id:"email",type:"email",className:"neu-input w-full",value:l,onChange:n=>m(n.target.value),required:!0}),r.email&&e.jsx("p",{className:"mt-1 text-destructive",children:r.email[0]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"password",className:"mb-2 block font-medium",children:"Password"}),e.jsx("input",{id:"password",type:"password",className:"neu-input w-full",value:d,onChange:n=>b(n.target.value),required:!0}),r.password&&e.jsx("p",{className:"mt-1 text-destructive",children:r.password[0]})]}),e.jsx("button",{type:"submit",className:"mb-4 w-full neu-button font-bold",disabled:x,children:x?"Logging in...":"Log In"}),e.jsxs("p",{className:"mt-4 text-center",children:["Don't have an account?"," ",e.jsx("button",{type:"button",className:"cursor-pointer font-medium text-primary underline underline-offset-2 transition-colors duration-200 hover:text-primary/80",onClick:c,children:"Register"})]})]})]})})}function S({onSwitchToLogin:c}){const[l,m]=a.useState(""),[d,b]=a.useState(""),[r,u]=a.useState(""),[x,p]=a.useState(""),[s,o]=a.useState({}),[n,i]=a.useState(!1),{login:f}=j(),N=async t=>{if(t.preventDefault(),i(!0),o({}),r!==x){o({passwordConfirmation:["Passwords do not match."]}),i(!1);return}try{const h=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:l,email:d,password:r})}),g=await h.json();if(!h.ok){o(g);return}f(g)}catch{o({message:["An unexpected error occurred. Please try again."]})}finally{i(!1)}};return e.jsx("div",{className:"mx-auto w-full max-w-md",children:e.jsxs("div",{className:"my-8 neu-card",children:[e.jsx("h2",{className:"mb-6 text-3xl font-bold",children:"Create Account"}),s.message&&e.jsx("div",{className:"mb-4 bg-destructive p-3 text-destructive-foreground",children:s.message.map((t,h)=>e.jsx("p",{children:t},h))}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"username",className:"mb-2 block font-medium",children:"Username"}),e.jsx("input",{id:"username",type:"text",className:"neu-input w-full",value:l,onChange:t=>m(t.target.value),required:!0}),s.username&&e.jsx("p",{className:"mt-1 text-destructive",children:s.username[0]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"mb-2 block font-medium",children:"Email"}),e.jsx("input",{id:"email",type:"email",className:"neu-input w-full",value:d,onChange:t=>b(t.target.value),required:!0}),s.email&&e.jsx("p",{className:"mt-1 text-destructive",children:s.email[0]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"password",className:"mb-2 block font-medium",children:"Password"}),e.jsx("input",{id:"password",type:"password",className:"neu-input w-full",value:r,onChange:t=>u(t.target.value),required:!0}),s.password&&e.jsx("p",{className:"mt-1 text-destructive",children:s.password[0]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"passwordConfirmation",className:"mb-2 block font-medium",children:"Confirm Password"}),e.jsx("input",{id:"passwordConfirmation",type:"password",className:"neu-input w-full",value:x,onChange:t=>p(t.target.value),required:!0}),s.passwordConfirmation&&e.jsx("p",{className:"mt-1 text-destructive",children:s.passwordConfirmation[0]})]}),e.jsx("button",{type:"submit",className:"mb-4 w-full neu-button font-bold",disabled:n,children:n?"Creating Account...":"Register"}),e.jsxs("p",{className:"mt-4 text-center",children:["Already have an account?"," ",e.jsx("button",{type:"button",className:"cursor-pointer font-medium text-primary underline underline-offset-2 transition-colors duration-200 hover:text-primary/80",onClick:c,children:"Log In"})]})]})]})})}function L(){const[c,l]=a.useState(!0),{isAuthenticated:m}=j();return m?e.jsx(w,{to:"/",replace:!0}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"mx-auto max-w-md",children:[e.jsxs("div",{className:"relative mb-8 text-center",children:[e.jsx("div",{className:"absolute top-0 right-0",children:e.jsx(v,{})}),e.jsx("h1",{className:"mb-2 text-4xl font-bold",children:"QueMe"}),e.jsx("p",{className:"text-muted-foreground",children:"Create your next music fixation."})]}),c?e.jsx(y,{onSwitchToRegister:()=>l(!1)}):e.jsx(S,{onSwitchToLogin:()=>l(!0)})]})})}export{L as default};
